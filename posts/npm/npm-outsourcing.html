<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="author" content="Lrsoy_"><link rel="icon" type="image/svg+xml" href="/book.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><title>发布npm包的过程</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app.53836b1a.js"></script><link rel="stylesheet" href="/assets/index.dbf12dd1.css"><link rel="modulepreload" crossorigin="" href="/assets/npm-outsourcing.b21199f2.js"><meta name="description" content="Ying Lau's Taking notes"><meta property="og:title" content="发布npm包的过程"><meta name="head:count" content="2"></head><body><div id="app" data-server-rendered="true"><!--[--><header><nav><a href="/" class="" title="Blog"><span>/</span></a><a href="/posts" class="" title="Blog"><span>知识汇总</span></a><a href="https://www.instagram.com/lrsoy_/" target="_blank" title="Instagram"><svg width="1.3em" height="1.3em" viewBox="0 0 512 512"><path fill="currentColor" d="M349.33 69.33a93.62 93.62 0 0 1 93.34 93.34v186.66a93.62 93.62 0 0 1-93.34 93.34H162.67a93.62 93.62 0 0 1-93.34-93.34V162.67a93.62 93.62 0 0 1 93.34-93.34h186.66m0-37.33H162.67C90.8 32 32 90.8 32 162.67v186.66C32 421.2 90.8 480 162.67 480h186.66C421.2 480 480 421.2 480 349.33V162.67C480 90.8 421.2 32 349.33 32Z"></path><path fill="currentColor" d="M377.33 162.67a28 28 0 1 1 28-28a27.94 27.94 0 0 1-28 28ZM256 181.33A74.67 74.67 0 1 1 181.33 256A74.75 74.75 0 0 1 256 181.33m0-37.33a112 112 0 1 0 112 112a112 112 0 0 0-112-112Z"></path></svg></a><a href="https://github.com/lrsoy" target="_blank" title="Github"><svg width="1.3em" height="1.3em" viewBox="0 0 24 24"><path fill="currentColor" d="M10.07 20.503a1 1 0 0 0-1.18-.983c-1.31.24-2.963.276-3.402-.958a5.708 5.708 0 0 0-1.837-2.415a1.2 1.2 0 0 1-.167-.11a1 1 0 0 0-.93-.645h-.005a1 1 0 0 0-1 .995c-.004.815.81 1.338 1.141 1.514a4.44 4.44 0 0 1 .924 1.36c.365 1.023 1.423 2.576 4.466 2.376l.003.098l.004.268a1 1 0 0 0 2 0l-.005-.318c-.005-.19-.012-.464-.012-1.182ZM20.737 5.377a5.39 5.39 0 0 0 .09-.42a6.278 6.278 0 0 0-.408-3.293a1.002 1.002 0 0 0-.615-.58c-.356-.12-1.67-.357-4.184 1.25a13.87 13.87 0 0 0-6.354 0C6.762.75 5.455.966 5.102 1.079a.997.997 0 0 0-.631.584a6.3 6.3 0 0 0-.404 3.357c.025.127.051.246.079.354a6.27 6.27 0 0 0-1.256 3.83a8.422 8.422 0 0 0 .043.921c.334 4.603 3.334 5.984 5.424 6.459a4.591 4.591 0 0 0-.118.4a1 1 0 0 0 1.942.479a1.678 1.678 0 0 1 .468-.878a1 1 0 0 0-.546-1.745c-3.454-.395-4.954-1.802-5.18-4.899a6.61 6.61 0 0 1-.033-.738a4.258 4.258 0 0 1 .92-2.713a3.022 3.022 0 0 1 .195-.231a1 1 0 0 0 .188-1.025a3.388 3.388 0 0 1-.155-.555a4.094 4.094 0 0 1 .079-1.616a7.543 7.543 0 0 1 2.415 1.18a1.009 1.009 0 0 0 .827.133a11.777 11.777 0 0 1 6.173.001a1.005 1.005 0 0 0 .83-.138a7.572 7.572 0 0 1 2.406-1.19a4.04 4.04 0 0 1 .087 1.578a3.205 3.205 0 0 1-.169.607a1 1 0 0 0 .188 1.025c.078.087.155.18.224.268A4.122 4.122 0 0 1 20 9.203a7.039 7.039 0 0 1-.038.777c-.22 3.056-1.725 4.464-5.195 4.86a1 1 0 0 0-.546 1.746a1.63 1.63 0 0 1 .466.908a3.06 3.06 0 0 1 .093.82v2.333c-.01.648-.01 1.133-.01 1.356a1 1 0 1 0 2 0c0-.217 0-.692.01-1.34v-2.35a4.881 4.881 0 0 0-.155-1.311a4.256 4.256 0 0 0-.116-.416a6.513 6.513 0 0 0 5.445-6.424A8.697 8.697 0 0 0 22 9.203a6.13 6.13 0 0 0-1.263-3.826Z"></path></svg></a><a class="select-none" title="Toggle Color Scheme"><svg width="1.3em" height="1.3em" viewBox="0 0 16 16" style=""><path fill="currentColor" d="M8 13a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0v-1a1 1 0 0 1 1-1zM8 3a1 1 0 0 1-1-1V1a1 1 0 0 1 2 0v1a1 1 0 0 1-1 1zm7 4a1 1 0 0 1 0 2h-1a1 1 0 0 1 0-2h1zM3 8a1 1 0 0 1-1 1H1a1 1 0 0 1 0-2h1a1 1 0 0 1 1 1zm9.95 3.536l.707.707a1 1 0 0 1-1.414 1.414l-.707-.707a1 1 0 0 1 1.414-1.414zm-9.9-7.072l-.707-.707a.999.999 0 1 1 1.414-1.414l.707.707A.999.999 0 1 1 3.05 4.464zm9.9 0a.999.999 0 1 1-1.414-1.414l.707-.707a.999.999 0 1 1 1.414 1.414l-.707.707zm-9.9 7.072a1 1 0 0 1 1.414 1.414l-.707.707a1 1 0 0 1-1.414-1.414l.707-.707zM8 4a4 4 0 1 0 0 8a4 4 0 0 0 0-8zm0 6.5a2.5 2.5 0 1 1 0-5a2.5 2.5 0 0 1 0 5z"></path></svg><svg width="1.3em" height="1.3em" viewBox="0 0 32 32" style="display:none"><path fill="currentColor" d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z"></path></svg></a></nav></header><main class="px-7 py-10"><div class="svg-bg"></div><!--[--><div class="titles prose"><h1 class="mb-0">发布npm包的过程</h1><p class="opacity-50 !-mt-2">Nov 10, 2022</p><!----></div><article><!--[--><div class="prose m-auto"><p></p><div class="table-of-contents"><ul><li><a href="#关于">关于</a></li><li><a href="#初始化">初始化</a></li><li><a href="#配置文件">配置文件</a></li><li><a href="#打包">打包</a></li><li><a href="#版本号">版本号</a></li><li><a href="#degit工具">Degit工具</a></li><li><a href="#账号登录">账号登录</a></li></ul></div><p></p><h2 id="关于" tabindex="-1">✨ 关于 <a class="header-anchor" href="#关于" aria-hidden="true">#</a></h2><h2 id="初始化" tabindex="-1">🧹 初始化 <a class="header-anchor" href="#初始化" aria-hidden="true">#</a></h2><p>初始化一个最基本的项目，选用经常使用的工具即可，<strong>yarn</strong>，<strong>pnpm</strong>，<strong>npm</strong>等等</p><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm init </span><span style="color:#ff79c6">-</span><span style="color:#f8f8f2">y </span><span style="color:#ff79c6">||</span><span style="color:#f8f8f2"> yarn init </span><span style="color:#6272a4">// 直接完成，跳过配置</span></span>
<span class="line"></span></code></pre><p>开发目录结构(工具类)<br><a href="https://www.toptal.com/developers/gitignore" target="_blank" rel="noopener">.gitignore自定义生成什么样的忽略文件</a></p><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">hello</span><span style="color:#ff79c6">-</span><span style="color:#f8f8f2">npm</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- dist/（ 存放打包后的文件,无需设置，通过打包生成 ）</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- src/（ 源码 ）</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- test/ ( 测试文件 )</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- package.json</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- build.config.ts ( unbuild打包配置文件 )</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- .npmrc ( 配置npm源 )</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- .gitignore ( 忽略文件配置 )</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- README.md</span></span>
<span class="line"><span style="color:#f8f8f2">|</span><span style="color:#6272a4">-- tsconfig.json (如果可以，推荐使用ts进行包的开发，如不需要ts则无需此配置文件)</span></span>
<span class="line"></span></code></pre><h2 id="配置文件" tabindex="-1">📂 配置文件 <a class="header-anchor" href="#配置文件" aria-hidden="true">#</a></h2><ul><li>基本配置文件结构 <strong>package.json</strong></li><li><a href="http://nodejs.cn/learn/the-package-json-guide" target="_blank" rel="noopener">package.json</a> 其他选项</li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">{</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">name</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">npm-cs</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 包的名称</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">version</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">1.0.0</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 包的版本</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">description</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">""</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 报的描述</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">main</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">index.js</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 设置了应用程序的入口点</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">author</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">lrsoy &lt;邮箱&gt;</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">, </span><span style="color:#6272a4">// 包的作者</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">license</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">ISC</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 认证</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#6272a4">/* 关于 github 仓库 */</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">homepage</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">""</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 软件包主页</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">repository</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {  </span><span style="color:#6272a4">// 此属性指定了此程序包仓库所在的位置</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">type</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">git</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">, </span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">url</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">git+https://github.com/lrsoy/parse-markdown-file.git</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">  </span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">bugs</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">issues</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 软件包的问题链接地址</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#6272a4">/* 关于包的入口文件 */</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">main</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.mjs</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,  </span><span style="color:#6272a4">// 设置软件包的入口点</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">scripts</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">test</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">echo </span><span style="color:#ff79c6">\"</span><span style="color:#f1fa8c">Error: no test specified</span><span style="color:#ff79c6">\"</span><span style="color:#f1fa8c"> &amp;&amp; exit 1</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">keywords</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> [],</span></span>
<span class="line"><span style="color:#f8f8f2">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><ul><li>项目依赖</li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">{</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">devDependencies</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> { </span><span style="color:#6272a4">// 表示开发环境下的依赖管理，--save-dev 简写 -D</span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">dependencies</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> { </span><span style="color:#6272a4">// 表示生产环境下的依赖管理，--save 简写 -S</span></span>
<span class="line"><span style="color:#f8f8f2">  }</span></span>
<span class="line"><span style="color:#f8f8f2">}</span></span>
<span class="line"></span></code></pre><ul><li><strong>files</strong> 字段，开发完成的包，不希望将源码都一并提交到<strong>npm</strong> 上，可以在files字段里面设置，哪一些文件可以被发布到npm上，也可以通过配置 <strong>.npmignore</strong> 文件配置什么文件可以被上传，如果同时设置，<strong>files</strong>字段会优先于配置文件。</li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">{  </span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">files</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> [</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">dist</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">  ]</span></span>
<span class="line"><span style="color:#f8f8f2">}</span></span>
<span class="line"></span></code></pre><h2 id="打包" tabindex="-1">📦 打包 <a class="header-anchor" href="#打包" aria-hidden="true">#</a></h2><p>开发完成的工具包，需要进行打包，选择打包工具，rollup与webpack，使用<a href="https://rollupjs.org/guide/en/" target="_blank" rel="noopener">rollup</a>打包，如果足够熟悉rollup打包，可以通过自定义配置进行打包，不想配置特别多的打包配置，可以选择使用<strong>unbuild</strong> 打包。</p><ul><li><a href="https://github.com/unjs/unbuild" target="_blank" rel="noopener">unbuild</a>介绍</li><li>关于<a href="https://www.typescriptlang.org/docs/handbook/declaration-files/publishing.html" target="_blank" rel="noopener">typesVersions</a></li><li>安装</li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">pnpm add unbuild -D</span></span>
<span class="line"><span style="color:#f8f8f2"></span></span></code></pre><ul><li>配置<strong>unbuild</strong></li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#6272a4">// create src/index.ts</span></span>
<span class="line"><span style="color:#ff79c6">export</span><span style="color:#f8f8f2"> </span><span style="color:#ff79c6">const</span><span style="color:#f8f8f2"> </span><span style="color:#50fa7b">log</span><span style="color:#f8f8f2"> </span><span style="color:#ff79c6">=</span><span style="color:#f8f8f2"> (</span><span style="color:#ff79c6">...</span><span style="color:#ffb86c;font-style:italic">args</span><span style="color:#f8f8f2">) </span><span style="color:#ff79c6">=&gt;</span><span style="color:#f8f8f2"> { console.</span><span style="color:#50fa7b">log</span><span style="color:#f8f8f2">(</span><span style="color:#ff79c6">...</span><span style="color:#f8f8f2">args) }</span></span>
<span class="line"></span></code></pre><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#6272a4">// package.json  unbuild在packages中的配置</span></span>
<span class="line"><span style="color:#f8f8f2">{</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">type</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">module</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">exports</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">.</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">      </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">types</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.d.ts</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">      </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">require</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.cjs</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">      </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">import</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.mjs</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">    }</span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">main</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.mjs</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">module</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.mjs</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">types</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.d.ts</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">files</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> [</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">dist</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">  ],</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">typesVersions</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">*</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">      </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">*</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> [</span></span>
<span class="line"><span style="color:#f8f8f2">        </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/*</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">        </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">./dist/index.d.ts</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">      ]</span></span>
<span class="line"><span style="color:#f8f8f2">    }</span></span>
<span class="line"><span style="color:#f8f8f2">  }</span></span>
<span class="line"><span style="color:#f8f8f2">}</span></span>
<span class="line"></span></code></pre><ul><li><strong>unbuild</strong> 的配置文件<code>build.config.ts</code></li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#ff79c6">import</span><span style="color:#f8f8f2"> { defineBuildConfig } </span><span style="color:#ff79c6">from</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">'</span><span style="color:#f1fa8c">unbuild</span><span style="color:#e9f284">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ff79c6">export</span><span style="color:#f8f8f2"> </span><span style="color:#ff79c6">default</span><span style="color:#f8f8f2"> </span><span style="color:#50fa7b">defineBuildConfig</span><span style="color:#f8f8f2">({</span></span>
<span class="line"><span style="color:#f8f8f2">  entries</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> [</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#e9f284">'</span><span style="color:#f1fa8c">src/index</span><span style="color:#e9f284">'</span><span style="color:#f8f8f2">, </span><span style="color:#6272a4">// 打包入口文件</span></span>
<span class="line"><span style="color:#f8f8f2">  ],</span></span>
<span class="line"><span style="color:#f8f8f2">  declaration</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#bd93f9">true</span><span style="color:#f8f8f2">, </span><span style="color:#6272a4">// 生成 .d.ts 声明文件</span></span>
<span class="line"><span style="color:#f8f8f2">  clean</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#bd93f9">true</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  rollup</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">    emitCJS</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#bd93f9">true</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><ul><li>运行脚本的配置<strong>scripts</strong></li></ul><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">{</span></span>
<span class="line"><span style="color:#f8f8f2">  </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">scripts</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> {</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">build</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">unbuild</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">, </span><span style="color:#6272a4">// 打包</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">dev</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">unbuild --stub</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">, </span><span style="color:#6272a4">// 暂时不解，正在寻找答案</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">lint</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">eslint .</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#6272a4">// prepublishOnly 如果不执行build </span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#6272a4">// 直接使用npm publish 该字段命令会优先与npm publish执行</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">prepublishOnly</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">nr build</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">release</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">bumpp &amp;&amp; npm publish</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">start</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">esno src/index.ts</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">test</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">vitest</span><span style="color:#e9f284">"</span><span style="color:#f8f8f2">,</span></span>
<span class="line"><span style="color:#f8f8f2">    </span><span style="color:#8be9fe">"</span><span style="color:#8be9fd">typecheck</span><span style="color:#8be9fe">"</span><span style="color:#ff79c6">:</span><span style="color:#f8f8f2"> </span><span style="color:#e9f284">"</span><span style="color:#f1fa8c">tsc --noEmit</span><span style="color:#e9f284">"</span></span>
<span class="line"><span style="color:#f8f8f2">  },</span></span>
<span class="line"><span style="color:#f8f8f2">}</span></span>
<span class="line"></span></code></pre><h2 id="版本号" tabindex="-1">🧷 版本号 <a class="header-anchor" href="#版本号" aria-hidden="true">#</a></h2><h2 id="degit工具" tabindex="-1">🛠️ Degit工具 <a class="header-anchor" href="#degit工具" aria-hidden="true">#</a></h2><h2 id="账号登录" tabindex="-1">✍️ 账号登录 <a class="header-anchor" href="#账号登录" aria-hidden="true">#</a></h2><p>要想发布自己开发好的包，最重要的就是需要注册一个npm的账号。<br><a href="https://www.npmjs.com/signup" target="_blank" rel="noopener">npm</a>。<br><a href="https://docs.npmjs.com/cli/v8/commands" target="_blank" rel="noopener">npm 指令</a></p><p><img src="https://img.shields.io/badge/vscode-v1.56.2-blue" alt="vscode"><br><img src="https://img.shields.io/badge/nodejs-v16.17.0-blue" alt="nodejs"><br><img src="https://img.shields.io/badge/npm-v8.15.0-blue" alt="npm"></p><ol><li>指定服务器</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm adduser</span></span>
<span class="line"></span></code></pre><ol start="2"><li>登录，输入指令 <strong>npm login</strong> 后提示一下信息，根据以下选项进行填写。</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#6272a4">// 使用的是你的 npm 的用户名</span></span>
<span class="line"><span style="color:#f8f8f2">Username: 用户名 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2"> </span><span style="color:#6272a4">// 使用的是你的 npm 登录秘密</span></span>
<span class="line"><span style="color:#f8f8f2">Password: 密码</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272a4">// 填写邮箱信息，填写后 npm 会向你发送邮件，复制邮件的验证码，填到下面选项里</span></span>
<span class="line"><span style="color:#f8f8f2">Email: (</span><span style="color:#bd93f9;font-style:italic">this</span><span style="color:#f8f8f2"> IS public): 邮箱 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272a4">// 填写邮箱中接收到的 8位验证码 例如：60175662</span></span>
<span class="line"><span style="color:#f8f8f2">Enter one</span><span style="color:#ff79c6">-</span><span style="color:#f8f8f2">time password: 验证码</span></span>
<span class="line"></span></code></pre><ol start="3"><li>退出当前登录账号</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm logout</span></span>
<span class="line"></span></code></pre><ol start="4"><li>查看当前登录者</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm who am i</span></span>
<span class="line"></span></code></pre><ol start="5"><li>将开发完成的包推送到npm服务器上</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm publish</span></span>
<span class="line"></span></code></pre><ol start="6"><li>模拟打包，生成本地的包，可以查看包里面的内容，完成后，本地会出现tgz的压缩包，就是要上传到npm上的内容</li></ol><pre class="shiki" style="background-color:#282a36"><code><span class="line"><span style="color:#f8f8f2">npm pack</span></span>
<span class="line"></span></code></pre></div><!--]--></article><div class="go-back prose"><a href="/posts/npm" class="font-mono no-underline opacity-50 hover:opacity-75">cd ..</a></div><!--]--></main><!--]--></div></body></html>